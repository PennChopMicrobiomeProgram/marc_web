{% extends 'base.html' %}

{% block body %}
<div class="container py-4">
  <a class="btn btn-link ps-0" href="{{ url_for('browse_isolates') }}">
    <i class="bi bi-arrow-left"></i> Back to isolates
  </a>
  <div class="card shadow-sm">
    <div class="card-header bg-primary text-white">
      <h2 class="h4 mb-0">Isolate {{ isolate.sample_id }}</h2>
    </div>
    <div class="card-body">
      <dl class="row mb-0">
        <dt class="col-sm-4">Sample ID</dt>
        <dd class="col-sm-8">{{ isolate.sample_id }}</dd>

        <dt class="col-sm-4">Subject ID</dt>
        <dd class="col-sm-8">{{ isolate.subject_id }}</dd>

        <dt class="col-sm-4">Specimen ID</dt>
        <dd class="col-sm-8">{{ isolate.specimen_id }}</dd>

        <dt class="col-sm-4">Suspected Organism</dt>
        <dd class="col-sm-8">
          {% if isolate.suspected_organism %}
          <a href="{{ url_for('show_species', species_name=isolate.suspected_organism) }}">
            {{ isolate.suspected_organism }}
          </a>
          {% else %}
          —
          {% endif %}
        </dd>

        <dt class="col-sm-4">Special Collection</dt>
        <dd class="col-sm-8">{{ isolate.special_collection or '—' }}</dd>

        <dt class="col-sm-4">Received Date</dt>
        <dd class="col-sm-8">{{ isolate.received_date or '—' }}</dd>

        <dt class="col-sm-4">Cryobanking Date</dt>
        <dd class="col-sm-8">{{ isolate.cryobanking_date or '—' }}</dd>
      </dl>
    </div>
  </div>

  <div class="card shadow-sm mt-4">
    <div class="card-header bg-light">
      <h3 class="h5 mb-0">Assemblies</h3>
    </div>
    <div class="card-body p-0">
      {% if assemblies %}
      <div class="table-responsive mb-0">
        <table class="table mb-0">
          <thead>
            <tr>
              <th scope="col">Assembly ID</th>
              <th scope="col">Metagenomic Sample ID</th>
              <th scope="col">Nanopore Path</th>
              <th scope="col">Run Number</th>
              <th scope="col">NCBI ID</th>
            </tr>
          </thead>
          <tbody>
            {% for assembly in assemblies %}
            <tr>
              <td>
                <a href="{{ url_for('show_assembly', assembly_id=assembly.id) }}">
                  {{ assembly.id }}
                </a>
              </td>
              <td>{{ assembly.metagenomic_sample_id or '—' }}</td>
              <td class="text-break">{{ assembly.nanopore_path or '—' }}</td>
              <td>{{ assembly.run_number or '—' }}</td>
              <td>{{ assembly.ncbi_id or '—' }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p class="mb-0 px-3 py-2">No assemblies have been recorded for this isolate yet.</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
