{% extends 'base.html' %}

{% block body %}
<div id="taxonomic_assignments_summary" class="summary span-24 last">
  <h2>Taxonomic Assignments</h2>
</div>

<div class="d-flex flex-row">
  <div class="d-flex p-5">
    <table class="display" id="taxonomic_assignments">
      <thead>
        <tr>
          <th>Assembly ID</th>
          <th>Isolate ID</th>
          <th>Tool</th>
          <th>Classification</th>
          <th>Comment</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script type="text/javascript">
$(document).ready(function () {
    const assignmentUrl = "{{ url_for('show_taxonomic_assignment', assembly_id=0)[:-1] }}";
    const speciesUrl = "{{ url_for('show_species', species_name='') }}";
    const oTable = createServerDataTable('#taxonomic_assignments', '{{ url_for('api_taxonomic_assignments') }}', [
        { data: 'assembly_id', render: function(d) { return '<a href="' + assignmentUrl + d + '">' + d + '</a>'; } },
        { data: 'isolate_id' },
        { data: 'tool' },
        { data: 'classification', render: function(value, type) {
            if (type !== 'display') {
                return value;
            }
            if (!value) {
                return '';
            }
            return '<a href="' + speciesUrl + encodeURIComponent(value) + '">' + value + '</a>';
        } },
        { data: 'comment' },
    ]);

    $('#taxonomic_assignments_filter').appendTo('#taxonomic_assignments_summary');
    $('#taxonomic_assignments_info').addClass('span-12');
    $('#taxonomic_assignments_paginate').addClass('span-12 last');
    oTable.draw();
});
</script>
{% endblock %}
